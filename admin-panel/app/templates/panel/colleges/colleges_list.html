{% extends "panel/base.html" %}

{% block title %}
–†—É–¥–Ω–µ–≤–æ - –ö–æ–ª–ª–µ–¥–∂–∏
{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/panel/colleges/colleges_list.css') }}">
<style>
    .btn-remove-image {
        background: #f44336;
        color: #fff;
        border: none;
        border-radius: 6px;
        padding: 8px 18px;
        font-size: 15px;
        cursor: pointer;
        margin-top: 10px;
        transition: background 0.2s;
        display: inline-block;
    }

    .btn-remove-image:hover {
        background: #c62828;
    }
</style>
{% endblock %}

{% block container %}
<div class="colleges-container">
    <div class="colleges-header">
        <div class="header-content">
            <h1>–ö–æ–ª–ª–µ–¥–∂–∏</h1>
        </div>
        <div class="colleges-actions">
            <button class="btn-create" onclick="createCollege()">
                <span class="btn-icon">+</span>
                –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–¥–∂
            </button>
        </div>
    </div>

    <div class="colleges-list">
        {% if colleges %}
            {% for college in colleges %}
            <div class="college-card" data-id="{{ college.id }}">
                <div class="college-image">
                    {% if college.image_url %}
                        <img src="{{ url_for('panel.college_image', college_id=college.id) }}" alt="{{ college.name }}">
                    {% else %}
                        <div class="no-image">
                            <span>üè´</span>
                        </div>
                    {% endif %}
                </div>
                <div class="college-content">
                    <div class="college-header-info">
                        <h3 class="college-name">{{ college.name }}</h3>
                    </div>
                    <div class="college-meta">
                        <span class="college-date">–°–æ–∑–¥–∞–Ω: {{ college.created_at }}</span>
                    </div>
                    <div class="college-actions">
                        <button class="btn-edit" onclick="editCollege({{ college.id }}, '{{ college.name|replace("'", "\\'") }}')">
                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn-toggle" onclick="toggleCollegeVisibility({{ college.id }})">
                            {% if college.is_active %}üëÅÔ∏è –°–∫—Ä—ã—Ç—å{% else %}üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å{% endif %}
                        </button>
                        <button class="btn-delete" onclick="deleteCollege({{ college.id }}, '{{ college.name|replace("'", "\\'") }}')">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-colleges">
                <div class="no-colleges-icon">üè´</div>
                <div class="no-colleges-text">–ö–æ–ª–ª–µ–¥–∂–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>
                <div class="no-colleges-subtext">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –∫–æ–ª–ª–µ–¥–∂</div>
            </div>
        {% endif %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–ª–µ–¥–∂–∞ -->
<div id="collegeModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">–°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–¥–∂</h2>
            <span class="close" onclick="closeCollegeModal()">&times;</span>
        </div>
        <form id="collegeForm" method="POST" action="{{ url_for('panel.college_create') }}" enctype="multipart/form-data">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
            <div class="form-group">
                <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–¥–∂–∞ *</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–ª–ª–µ–¥–∂–∞ *</label>
                <div id="imageBlock">
                    <img id="imagePreview" src="" alt="–ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                        style="display:none;max-width:100%;margin-top:10px;" />
                    <button type="button" id="removeImageBtn" style="display:none;margin-top:10px;"
                        class="btn-remove-image">–£–¥–∞–ª–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
                    <input type="file" id="image" name="image" accept="image/*" required />
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-cancel" onclick="closeCollegeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </form>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h2>
            <span class="close" onclick="closeDeleteModal()">&times;</span>
        </div>
        <div class="modal-body">
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–æ–ª–ª–µ–¥–∂ "<span id="deleteCollegeName"></span>"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeDeleteModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn-delete" onclick="confirmDelete()">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/panel/colleges/colleges_list.js') }}"></script>
{% endblock %} 