{% extends "panel/base.html" %}

{% block title %}
–†—É–¥–Ω–µ–≤–æ - –í–æ–ø—Ä–æ—Å—ã
{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/panel/feedback/feedback_list.css') }}">
{% endblock %}

{% block container %}
<div class="feedback-container">
    <div class="feedback-header">
        <div class="header-content">
            <h1>–í–æ–ø—Ä–æ—Å—ã</h1>
        </div>
    </div>

    <div class="feedback-stats">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">‚ùì</div>
                <div class="stat-content">
                    <div class="stat-number">{{ feedbacks|length }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-content">
                    <div class="stat-number">{{ feedbacks|length }}</div>
                    <div class="stat-label">–û–∂–∏–¥–∞—é—Ç –æ—Ç–≤–µ—Ç–∞</div>
                </div>
            </div>
        </div>
    </div>

    <div class="feedback-list">
        {% for feedback_item in feedbacks %}
        <div class="feedback-card">
            <div class="feedback-icon">
                <div class="icon-placeholder">
                    <span>‚ùì</span>
                </div>
            </div>
            <div class="feedback-content">
                <div class="feedback-header-info">
                    <h3 class="feedback-title">
                        <span>
                            {% if feedback_item.name and feedback_item.name|length > 50 %}
                            {{ feedback_item.name[:50] }}...
                            {% else %}
                            {{ feedback_item.name }}
                            {% endif %}
                        </span>
                    </h3>
                </div>
                <div class="feedback-excerpt">
                    <span>
                        {% if feedback_item.message and feedback_item.message|length > 100 %}
                        {{ feedback_item.message[:100] }}...
                        {% else %}
                        {{ feedback_item.message }}
                        {% endif %}
                    </span>
                </div>
                <div class="feedback-meta">
                    <div class="feedback-info">
                        <span class="feedback-email">{{ feedback_item.email }}</span>
                        <span class="feedback-date">{{ feedback_item.created_at }}</span>
                    </div>
                    <div class="feedback-actions">
                        <button type="button" class="btn-edit"
                            onclick="return respondToFeedback({{ feedback_item.id }})">
                            <span class="btn-icon">‚úèÔ∏è</span>
                            –û—Ç–≤–µ—Ç–∏—Ç—å
                        </button>
                        <form method="POST"
                            action="{{ url_for('panel.feedback_delete', feedback_id=feedback_item.id) }}"
                            style="display: inline;">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
                            <button type="submit" class="btn-delete"
                                onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')">
                                <span class="btn-icon">üóëÔ∏è</span>
                                –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

        {% if not feedbacks %}
        <div class="no-feedback">
            <div class="no-feedback-icon">‚ùì</div>
            <div class="no-feedback-text">–í–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>
            <div class="no-feedback-subtext">–í–æ–ø—Ä–æ—Å—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Ç–ø—Ä–∞–≤—è—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å</div>
        </div>
        {% endif %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å -->
<div id="responseModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å</h2>
            <span class="close" onclick="closeResponseModal()">&times;</span>
        </div>
        <form id="responseForm" method="post">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
            <div class="form-group">
                <label for="response_text">–í–∞—à –æ—Ç–≤–µ—Ç *</label>
                <textarea id="response_text" name="response_text" rows="6" required
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-cancel" onclick="closeResponseModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn-save">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/panel/feedback/feedback_list.js') }}"></script>
{% endblock %}