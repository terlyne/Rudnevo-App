{% extends "panel/base.html" %}

{% block title %}
–†—É–¥–Ω–µ–≤–æ - –í–∞–∫–∞–Ω—Å–∏–∏
{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/panel/vacancies/vacancies_list.css') }}">
{% endblock %}

{% block container %}
<div class="vacancies-container">
    <div class="vacancies-header">
        <h1>–í–∞–∫–∞–Ω—Å–∏–∏</h1>
        <a href="{{ url_for('panel.vacancy_create') }}" class="btn-create">
            <span class="btn-icon">+</span>
            –°–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é
        </a>
    </div>

    <div class="vacancies-filters">
        <label class="filter-checkbox">
            <input type="checkbox" id="showHidden" {% if show_hidden %}checked{% endif %} onchange="toggleHiddenVacancies()">
            <span class="checkmark"></span>
            –ü–æ–∫–∞–∑–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏
        </label>
    </div>

    <div class="vacancies-scroll">
        {% for vacancy in vacancies %}
        <div class="vacancy-item {% if vacancy.is_hidden %}hidden{% endif %}">
            <div class="vacancy-header">
                <div class="vacancy-title-section">
                    <h3 class="vacancy-title">{{ vacancy.title }}</h3>
                    <div class="vacancy-status">
                        {% if vacancy.is_hidden %}
                        <span class="status-hidden">–°–∫—Ä—ã—Ç–∞</span>
                        {% else %}
                        <span class="status-active">–ê–∫—Ç–∏–≤–Ω–∞</span>
                        {% endif %}
                    </div>
                </div>
                <div class="vacancy-actions">
                    <a href="{{ url_for('panel.vacancy_applications', vacancy_id=vacancy.id) }}"
                        class="btn-applications">–ó–∞—è–≤–∫–∏ ({{ vacancy.statistics.total_applications }})</a>
                    <form method="POST" action="{{ url_for('panel.vacancy_edit', vacancy_id=vacancy.id) }}" style="display: inline;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
                        <button type="submit" class="btn-edit" onclick="return editVacancy({{ vacancy.id }})">
                            <span class="btn-icon">‚úèÔ∏è</span>
                            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </form>
                    <form method="POST" action="{{ url_for('panel.vacancy_delete', vacancy_id=vacancy.id) }}" style="display: inline;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
                        <button type="submit" class="btn-delete" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')">
                            <span class="btn-icon">üóëÔ∏è</span>
                            –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </form>
                </div>
            </div>

            <div class="vacancy-details">
                <div class="vacancy-info">
                    <div class="info-row">
                        <span class="info-label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</span>
                        <span class="info-value">{{ vacancy.direction }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:</span>
                        <span class="info-value">{{ vacancy.speciality }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–§–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã:</span>
                        <span class="info-value">{{ vacancy.work_format }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ü–µ—Ä–∏–æ–¥:</span>
                        <span class="info-value">{{ vacancy.start }} - {{ vacancy.end }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ:</span>
                        <span class="info-value">{{ vacancy.contact_person }}</span>
                    </div>
                </div>

                <div class="vacancy-statistics">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</span>
                            <span class="stat-value">{{ vacancy.statistics.total_applications }}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–ù–æ–≤—ã–µ</span>
                            <span class="stat-value new">{{ vacancy.statistics.new_applications }}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–í —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span>
                            <span class="stat-value review">{{ vacancy.statistics.in_review_applications }}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–ü—Ä–∏–≥–ª–∞—à–µ–Ω—ã</span>
                            <span class="stat-value invited">{{ vacancy.statistics.invited_applications }}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–û—Ç–∫–∞–∑—ã</span>
                            <span class="stat-value rejected">{{ vacancy.statistics.rejected_applications }}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–ö–æ–Ω–≤–µ—Ä—Å–∏—è</span>
                            <span class="stat-value conversion">{{ vacancy.statistics.conversion_rate }}%</span>
                        </div>
                    </div>

                    <div class="vacancy-progress">
                        <div class="progress-info">
                            <span>–ó–∞–ø–æ–ª–Ω–µ–Ω–æ: {{ vacancy.statistics.total_applications }}/{{ vacancy.required_amount }}</span>
                            {% if vacancy.statistics.is_full %}
                            <span class="status-full">–í–∞–∫–∞–Ω—Å–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∞</span>
                            {% endif %}
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill"
                                style="width: {{ [vacancy.statistics.total_applications / vacancy.required_amount * 100, 100] | min }}%">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="vacancy-description">
                <h4>–û–ø–∏—Å–∞–Ω–∏–µ:</h4>
                <p>{{ vacancy.description[:200] }}{% if vacancy.description|length > 200 %}...{% endif %}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- –§–æ—Ä–º–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏ -->
<form id="delete-form" method="POST" style="display: none;">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
</form>

<script src="{{ url_for('static', filename='js/panel/vacancies/vacancies_list.js') }}"></script>
{% endblock %}