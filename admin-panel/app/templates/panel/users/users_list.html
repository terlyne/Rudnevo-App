{% extends "panel/base.html" %}

{% block title %}
–†—É–¥–Ω–µ–≤–æ - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/panel/users/users_list.css') }}">
{% endblock %}

{% block container %}
<div class="users-container">
    <div class="users-header">
        <h1>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h1>
        <button class="btn-invite" onclick="inviteUser()">
            <span class="btn-icon">üìß</span>
            –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        </button>
    </div>

    <div class="users-stats">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-content">
                    <div class="stat-number">{{ users|length }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üëë</div>
                <div class="stat-content">
                    <div class="stat-number">{{ users|selectattr('is_superuser', 'equalto', True)|list|length }}</div>
                    <div class="stat-label">–°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üíº</div>
                <div class="stat-content">
                    <div class="stat-number">{{ users|selectattr('is_recruiter', 'equalto', True)|list|length }}</div>
                    <div class="stat-label">–†–µ–∫—Ä—É—Ç–µ—Ä–æ–≤</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-content">
                    <div class="stat-number">{{ users|selectattr('is_registered', 'equalto', False)|list|length }}</div>
                    <div class="stat-label">–û–∂–∏–¥–∞—é—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                </div>
            </div>
        </div>
    </div>

    <div class="users-list">
        {% if users %}
            {% for user in users %}
            <div class="user-card {% if not user.is_registered %}pending{% endif %}">
                <div class="user-avatar">
                    <div class="avatar-placeholder">
                        {% if user.is_superuser %}
                            üëë
                        {% elif user.is_recruiter %}
                            üíº
                        {% else %}
                            üë§
                        {% endif %}
                    </div>
                </div>
                
                <div class="user-content">
                    <div class="user-header">
                        <div class="user-info">
                            <div class="user-name">
                                {% if user.username %}
                                    {{ user.username }}
                                {% else %}
                                    <em>–ù–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω</em>
                                {% endif %}
                            </div>
                            <div class="user-email">{{ user.email }}</div>
                        </div>
                        <div class="user-status">
                            {% if user.is_superuser %}
                                <span class="status-superuser">–°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                            {% elif user.is_recruiter %}
                                <span class="status-recruiter">–†–µ–∫—Ä—É—Ç–µ—Ä</span>
                            {% else %}
                                <span class="status-admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                            {% endif %}
                            
                            {% if not user.is_registered %}
                                <span class="status-pending">–û–∂–∏–¥–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="user-meta">
                        <div class="user-dates">
                            {% if user.created_at %}
                                <span class="created-date">–°–æ–∑–¥–∞–Ω: {{ user.created_at }}</span>
                            {% endif %}
                            {% if user.is_registered and user.updated_at %}
                                <span class="updated-date">–û–±–Ω–æ–≤–ª–µ–Ω: {{ user.updated_at }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <div class="user-actions">
                    <form method="POST" action="{{ url_for('panel.user_delete', user_id=user.id) }}" style="display: inline;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
                        <button type="submit" class="btn-delete" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')">
                            <span class="btn-icon">üóëÔ∏è</span>
                            –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-users">
                <div class="no-users-icon">üë•</div>
                <div class="no-users-text">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</div>
                <div class="no-users-subtext">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"</div>
            </div>
        {% endif %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<div id="inviteModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <span class="close" onclick="closeInviteModal()">&times;</span>
        </div>
        <form id="inviteForm">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
            <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" name="email" required placeholder="–í–≤–µ–¥–∏—Ç–µ email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="is_recruiter" name="is_recruiter">
                    <span class="checkmark"></span>
                    –†–µ–∫—Ä—É—Ç–µ—Ä (–¥–æ—Å—Ç—É–ø –∫ –≤–∞–∫–∞–Ω—Å–∏—è–º)
                </label>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-cancel" onclick="closeInviteModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn-save">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/panel/users/users_list.js') }}"></script>
{% endblock %}